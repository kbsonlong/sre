<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Git分支-分支原理 - 蜷缩的蜗牛</title><meta name=author content="kbsonlong"><meta name=author-link content><meta name=description content="Git分支-分支原理 Git 处理分支的方式可谓是难以置信的轻量，创建新分支这一操作几乎能在瞬间完成，并且在不同分支之间的切换操作也是一样便捷。 与许"><meta name=keywords content="Git"><meta itemprop=name content="Git分支-分支原理"><meta itemprop=description content="Git分支-分支原理 Git 处理分支的方式可谓是难以置信的轻量，创建新分支这一操作几乎能在瞬间完成，并且在不同分支之间的切换操作也是一样便捷。 与许"><meta itemprop=datePublished content="2020-11-18T17:43:57+00:00"><meta itemprop=dateModified content="2020-11-18T17:43:57+00:00"><meta itemprop=wordCount content="2165"><meta itemprop=image content="http://devops.alongparty.cn/logo_transparent.png"><meta itemprop=keywords content="Git,"><meta property="og:title" content="Git分支-分支原理"><meta property="og:description" content="Git分支-分支原理 Git 处理分支的方式可谓是难以置信的轻量，创建新分支这一操作几乎能在瞬间完成，并且在不同分支之间的切换操作也是一样便捷。 与许"><meta property="og:type" content="article"><meta property="og:url" content="http://devops.alongparty.cn/posts/git%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E5%8E%9F%E7%90%86/"><meta property="og:image" content="http://devops.alongparty.cn/logo_transparent.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-11-18T17:43:57+00:00"><meta property="article:modified_time" content="2020-11-18T17:43:57+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://devops.alongparty.cn/logo_transparent.png"><meta name=twitter:title content="Git分支-分支原理"><meta name=twitter:description content="Git分支-分支原理 Git 处理分支的方式可谓是难以置信的轻量，创建新分支这一操作几乎能在瞬间完成，并且在不同分支之间的切换操作也是一样便捷。 与许"><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#252627"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://devops.alongparty.cn/posts/git%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E5%8E%9F%E7%90%86/><link rel=prev href=http://devops.alongparty.cn/posts/git%E5%88%86%E6%94%AF-%E8%BF%9C%E7%A8%8B%E5%88%86%E6%94%AF/><link rel=next href=http://devops.alongparty.cn/posts/git%E5%88%86%E6%94%AF-%E5%8F%98%E5%9F%BA/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Git分支-分支原理","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/devops.alongparty.cn\/posts\/git%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E5%8E%9F%E7%90%86\/"},"genre":"posts","keywords":"Git","wordcount":2165,"url":"http:\/\/devops.alongparty.cn\/posts\/git%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E5%8E%9F%E7%90%86\/","datePublished":"2020-11-18T17:43:57+00:00","dateModified":"2020-11-18T17:43:57+00:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"kbsonlong"},"description":""}</script></head><body header-desktop=sticky header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper github-corner=right><div class=header-title><a href=/ title=蜷缩的蜗牛><img class="lazyload logo" src=/svg/loading.min.svg data-src=/logo_transparent.png data-srcset="/logo_transparent.png, /logo_transparent.png 1.5x, /logo_transparent.png 2x" data-sizes=auto alt=蜷缩的蜗牛 title=蜷缩的蜗牛><span class=header-title-text>蜷缩的蜗牛</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/posts/><i class='fa-solid fa-archive fa-fw fa-sm'></i> 文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class='fa-solid fa-th fa-fw fa-sm'></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class='fa-solid fa-tags fa-fw fa-sm'></i> 标签</a></li><li class=menu-item><a class=menu-link href=/friends/ title=友情链接><i class='fa-solid fa-users fa-fw fa-sm'></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class='fa-solid fa-info-circle fa-fw fa-sm'></i> 关于</a></li><li class="menu-item d-none-desktop text-center"><a class=menu-link href=https://github.com/kbsonlong/ title=GitHub rel="noopener noreferrer" target=_blank><i class='fa-brands fa-github fa-fw'></i></a></li><li class="menu-item d-none-desktop text-center"><a class=menu-link href=/messages/><i class='fa-solid fa-messages'></i> 留言板</a></li><li class=menu-item><a class=menu-link href=/messages/ title=留言板>留言板</a></li><li class="menu-item delimiter"></li><li class="menu-item language"><span title=选择语言>简体中文<i class="dropdown-icon fa-solid fa-chevron-down"></i></span><ul class=sub-menu><li class=menu-item>没有更多翻译</li></ul></li><li class="menu-item search" id=search-desktop><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin"></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw"></i></li></ul></nav></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=蜷缩的蜗牛><img class="lazyload logo" src=/svg/loading.min.svg data-src=/logo_transparent.png data-srcset="/logo_transparent.png, /logo_transparent.png 1.5x, /logo_transparent.png 2x" data-sizes=auto alt=/logo_transparent.png title=/logo_transparent.png><span class=header-title-text>蜷缩的蜗牛</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/posts/><i class='fa-solid fa-archive fa-fw fa-sm'></i> 文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class='fa-solid fa-th fa-fw fa-sm'></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class='fa-solid fa-tags fa-fw fa-sm'></i> 标签</a></li><li class=menu-item><a class=menu-link href=/friends/ title=友情链接><i class='fa-solid fa-users fa-fw fa-sm'></i> 友链</a></li><li class=menu-item><a class=menu-link href=/about/><i class='fa-solid fa-info-circle fa-fw fa-sm'></i> 关于</a></li><li class="menu-item d-none-desktop text-center"><a class=menu-link href=https://github.com/kbsonlong/ title=GitHub rel="noopener noreferrer" target=_blank><i class='fa-brands fa-github fa-fw'></i></a></li><li class="menu-item d-none-desktop text-center"><a class=menu-link href=/messages/><i class='fa-solid fa-messages'></i> 留言板</a></li><li class=menu-item><a class=menu-link href=/messages/ title=留言板>留言板</a></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw"></i></li><li class="menu-item language"><span title=选择语言>简体中文<i class="dropdown-icon fa-solid fa-chevron-down"></i></span>
<select class=language-select onchange="location=this.value"><option disabled>没有更多翻译</option></select></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=container page-style=normal><aside class=toc id=toc-auto><h2 class=toc-title>目录 <i class="toc-icon fa-solid fa-angle-down fa-fw"></i></h2><div class=toc-content id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>Git分支-分支原理</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><i class="fa-solid fa-user-circle"></i></span></span>
<span class=post-category>收录于 <a href=/categories/git%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/><i class="fa-regular fa-folder fa-fw"></i>&nbsp;《Git》学习笔记</a></span></div><div class=post-meta-line><span title="2020-11-18 17:43:57"><i class="fa-regular fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2020-11-18>2020-11-18</time>
</span>&nbsp;<i class="fa-solid fa-pencil-alt fa-fw"></i>&nbsp;约 2165 字&nbsp;
<i class="fa-regular fa-clock fa-fw"></i>&nbsp;预计阅读 5 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#首次提交>首次提交</a><ul><li><a href=#小结>小结：</a></li></ul></li><li><a href=#再次提交>再次提交</a></li><li><a href=#git-的分支>Git 的分支</a></li><li><a href=#创建分支>创建分支</a></li><li><a href=#当前分支的指针>当前分支的指针</a></li><li><a href=#查看当前所在分支>查看当前所在分支</a></li><li><a href=#分支切换>分支切换</a></li><li><a href=#创建分支同时切换>创建分支同时切换</a></li></ul></li></ul></nav></div></div><div class=content id=content><h1 id=git分支-分支原理>Git分支-分支原理</h1><p>Git 处理分支的方式可谓是难以置信的轻量，创建新分支这一操作几乎能在瞬间完成，并且在不同分支之间的切换操作也是一样便捷。 与许多其它版本控制系统不同，Git 鼓励在工作流程中频繁地使用分支与合并，哪怕一天之内进行许多次。</p><h3 id=首次提交>首次提交</h3><p>在进行提交操作时，Git 会保存一个提交对象（commit object）。</p><p>假设现在有一个工作目录，里面包含了三个将要被暂存和提交的文件。 暂存操作会为每一个文件计算校验和（使用 SHA-1 哈希算法），然后会把当前版本的文件快照保存到 Git 仓库中 （Git 使用 <em>blob</em> 对象来保存它们），最终将校验和加入到暂存区域等待提交：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ git add README test.rb LICENSE
</span></span><span class=line><span class=cl>$ git commit -m <span class=s1>&#39;The initial commit of my project&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>当使用 <code>git commit</code> 进行提交操作时，Git 会先计算每一个子目录（本例中只有项目根目录）的校验和， 然后在 Git 仓库中这些校验和保存为树对象。随后，Git 便会创建一个提交对象， 它除了包含上面提到的那些信息外，还包含指向这个树对象（项目根目录）的指针。 如此一来，Git 就可以在需要的时候重现此次保存的快照。</p><p>现在，Git 仓库中有五个对象：三个 <strong><em>blob</em> 对象</strong>（保存着文件快照）、一个 <strong>树对象</strong> （记录着目录结构和 blob 对象索引）以及一个 <strong>提交对象</strong>（包含着指向前述树对象的指针和所有提交信息）。</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906145443.jpg data-srcset="https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906145443.jpg, https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906145443.jpg 1.5x, https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906145443.jpg 2x" data-sizes=auto alt=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906145443.jpg title=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906145443.jpg></p><p align=center>图1. 首次提交对象及其树结构 ▲</p><h4 id=小结>小结：</h4><ol><li><p><code>git add</code> 加入暂存操作，会为每个文件创建计算校验和，以及每个文件对应的<strong>文件快照（blob对象</strong>）。</p></li><li><p><code>git commit</code> 提交操作，计算子目录或跟目录的校验和 保存为<strong>树对象</strong>。随后，创建一个<strong>提交对象</strong>，包含着指向树对象的指针和所有提交信息。</p></li></ol><h3 id=再次提交>再次提交</h3><p>做些修改后再次提交，那么这次产生的提交对象会包含一个指向上次提交对象（父对象）的指针。</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906152315.jpg data-srcset="https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906152315.jpg, https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906152315.jpg 1.5x, https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906152315.jpg 2x" data-sizes=auto alt=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906152315.jpg title=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906152315.jpg></p><p align=center>图2. 提交对象及其父对象 ▲</p><h3 id=git-的分支>Git 的分支</h3><p><strong>Git 的分支，其实本质上仅仅是指向提交对象的可变指针</strong>。 Git 的默认分支名字是 <code>master</code>。 在多次提交操作之后，你其实已经有一个指向最后那个提交对象的 <code>master</code> 分支。 <strong><code>master</code> 分支指针会在每次提交时自动向前移动</strong>。</p><blockquote><p>Git 的 <code>master</code> 分支并不是一个特殊分支。 它就跟其它分支完全没有区别。</p></blockquote><p><img class=lazyload src=/svg/loading.min.svg data-src=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906154109.jpg data-srcset="https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906154109.jpg, https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906154109.jpg 1.5x, https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906154109.jpg 2x" data-sizes=auto alt=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906154109.jpg title=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906154109.jpg></p><p align=center>图3. 分支及其提交历史 ▲</p><h3 id=创建分支>创建分支</h3><p>Git 是怎么创建新分支的呢？ 很简单，它<strong>只是为你创建了一个可以移动的新的指针</strong>。 比如，创建一个 testing 分支， 你需要使用 <code>git branch</code> 命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ git branch testing
</span></span></code></pre></td></tr></table></div></div><p>这会在当前所在的提交对象上创建一个指针。</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906154330.png data-srcset="https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906154330.png, https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906154330.png 1.5x, https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906154330.png 2x" data-sizes=auto alt=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906154330.png title=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906154330.png></p><p align=center>图4. 两个指向相同提交历史的分支 ▲</p><h3 id=当前分支的指针>当前分支的指针</h3><p>Git 是怎么知道当前在哪一个分支上呢？ 很简单，它有一个<strong>名为 <code>HEAD</code> 的特殊指针</strong>，<strong>指向当前所在的本地分支</strong>（译注：<strong>将 <code>HEAD</code> 想象为当前分支的别名</strong>）。 在本例中，你仍然在 <code>master</code> 分支上。 因为 <code>git branch</code> 命令仅仅 <strong>创建</strong> 一个新分支，并不会自动切换到新分支中去。</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906205325.png data-srcset="https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906205325.png, https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906205325.png 1.5x, https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906205325.png 2x" data-sizes=auto alt=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906205325.png title=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906205325.png></p><p align=center>图5. HEAD 指向当前所在的分支 ▲</p><h3 id=查看当前所在分支>查看当前所在分支</h3><p>你可以简单地使用 <code>git log</code> 命令查看各个分支当前所指的对象。 提供这一功能的参数是 <code>--decorate</code>。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ git log --oneline --decorate
</span></span><span class=line><span class=cl>f30ab <span class=o>(</span>HEAD -&gt; master, testing<span class=o>)</span> add feature <span class=c1># f30ab提交对象 (HEAD当前所在分支 -&gt; master分支，testing 分支)</span>
</span></span><span class=line><span class=cl>34ac2 Fixed bug <span class=c1># 34ac2 提交对象</span>
</span></span><span class=line><span class=cl>98ca9 The initial commit of my project <span class=c1># 98ca9 提交对象</span>
</span></span></code></pre></td></tr></table></div></div><p>正如你所见，当前 <code>master</code> 和 <code>testing</code> 分支均指向校验和以 <code>f30ab</code> 开头的提交对象。</p><h3 id=分支切换>分支切换</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ git checkout testing  <span class=c1># git checkout &lt;分支名&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>这样 <code>HEAD</code> 就指向 <code>testing</code> 分支了。</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906205917.png data-srcset="https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906205917.png, https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906205917.png 1.5x, https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906205917.png 2x" data-sizes=auto alt=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906205917.png title=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906205917.png></p><p align=center>图6. HEAD 指向当前所在的分支 ▲</p><p>那么，这样的实现方式会给我们带来什么好处呢？ 现在不妨再提交一次：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ vim test.rb
</span></span><span class=line><span class=cl>$ git commit -a -m <span class=s1>&#39;made a change&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading.min.svg data-src=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906210338.png data-srcset="https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906210338.png, https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906210338.png 1.5x, https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906210338.png 2x" data-sizes=auto alt=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906210338.png title=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906210338.png></p><p align=center>图7. HEAD 分支随着提交操作自动向前移动 ▲</p><p>如图所示，你的 <code>testing</code> 分支向前移动了，但是 <code>master</code> 分支却没有，它仍然指向运行 <code>git checkout</code> 时所指的对象。 这就有意思了，现在我们切换回 <code>master</code> 分支看看：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ git checkout master
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading.min.svg data-src=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906210810.png data-srcset="https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906210810.png, https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906210810.png 1.5x, https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906210810.png 2x" data-sizes=auto alt=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906210810.png title=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906210810.png></p><p align=center>图8. 检出时 HEAD 随之移动 ▲</p><p>这条命令<strong>做了两件事</strong>。 <strong>一是使 HEAD 指回 <code>master</code> 分支，二是将工作目录恢复成 <code>master</code> 分支所指向的快照内容</strong>。 也就是说，你现在做修改的话，项目将始于一个较旧的版本。 本质上来讲，这就是忽略 <code>testing</code> 分支所做的修改，以便于向另一个方向进行开发。</p><p>我们不妨再稍微做些修改并提交：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ vim test.rb
</span></span><span class=line><span class=cl>$ git commit -a -m <span class=s1>&#39;made other changes&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>现在，这个项目的提交历史已经产生了分叉（参见 <a href=https://git-scm.com/book/zh/v2/ch00/divergent_history target=_blank rel="external nofollow noopener noreferrer">项目分叉历史</a>）。 因为刚才你创建了一个新分支，并切换过去进行了一些工作，随后又切换回 master 分支进行了另外一些工作。 上述两次改动针对的是不同分支：你可以在不同分支间不断地来回切换和工作，并在时机成熟时将它们合并起来。 而所有这些工作，你需要的命令只有 <code>branch</code>、<code>checkout</code> 和 <code>commit</code>。</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906211331.png data-srcset="https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906211331.png, https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906211331.png 1.5x, https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906211331.png 2x" data-sizes=auto alt=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906211331.png title=https://cdn.jsdelivr.net/gh/xugaoyi/image_store/blog/20200906211331.png></p><p align=center>图9. 项目分叉历史 ▲</p><p>你可以简单地使用 <code>git log</code> 命令查看分叉历史。 运行 <code>git log --oneline --decorate --graph --all</code> ，它会输出你的提交历史、各个分支的指向以及项目的分支分叉情况。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ git log --oneline --decorate --graph --all
</span></span><span class=line><span class=cl>* c2b9e <span class=o>(</span>HEAD, master<span class=o>)</span> made other changes
</span></span><span class=line><span class=cl><span class=p>|</span> * 87ab2 <span class=o>(</span>testing<span class=o>)</span> made a change
</span></span><span class=line><span class=cl><span class=p>|</span>/
</span></span><span class=line><span class=cl>* f30ab add feature
</span></span><span class=line><span class=cl>* 34ac2 fixed bug
</span></span><span class=line><span class=cl>* 98ca9 initial commit of my project
</span></span></code></pre></td></tr></table></div></div><p>由于 Git 的分支实质上仅是包含所指对象校验和（长度为 40 的 SHA-1 值字符串）的文件，所以它的创建和销毁都异常高效。 创建一个新分支就相当于往一个文件中写入 41 个字节（40 个字符和 1 个换行符），如此的简单能不快吗？</p><p>这与过去大多数版本控制系统形成了鲜明的对比，它们在创建分支时，将所有的项目文件都复制一遍，并保存到一个特定的目录。 完成这样繁琐的过程通常需要好几秒钟，有时甚至需要好几分钟。所需时间的长短，完全取决于项目的规模。 而在 Git 中，任何规模的项目都能在瞬间创建新分支。 同时，由于每次提交都会记录父对象，所以寻找恰当的合并基础（译注：即共同祖先）也是同样的简单和高效。 这些高效的特性使得 Git 鼓励开发人员频繁地创建和使用分支。</p><h3 id=创建分支同时切换>创建分支同时切换</h3><p>通常我们会在创建一个新分支后立即切换过去，可以使用如下命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>git checkout -b &lt;newbranchname&gt;
</span></span></code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="2020-11-18 17:43:57">更新于 2020-11-18</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/git%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E5%8E%9F%E7%90%86/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=http://devops.alongparty.cn/posts/git%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E5%8E%9F%E7%90%86/ data-title=Git分支-分支原理 data-hashtags=Git><i class="fa-brands fa-twitter fa-fw"></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=http://devops.alongparty.cn/posts/git%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E5%8E%9F%E7%90%86/ data-hashtag=Git><i class="fa-brands fa-facebook-square fa-fw"></i></a>
<a href=javascript:void(0); title="分享到 WhatsApp" data-sharer=whatsapp data-url=http://devops.alongparty.cn/posts/git%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E5%8E%9F%E7%90%86/ data-title=Git分支-分支原理 data-web><i class="fa-brands fa-whatsapp fa-fw"></i></a>
<a href=javascript:void(0); title="分享到 Line" data-sharer=line data-url=http://devops.alongparty.cn/posts/git%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E5%8E%9F%E7%90%86/ data-title=Git分支-分支原理><i data-svg-src=/lib/simple-icons/icons/line.min.svg></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=http://devops.alongparty.cn/posts/git%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E5%8E%9F%E7%90%86/ data-title=Git分支-分支原理><i class="fa-brands fa-weibo fa-fw"></i></a>
<a href=javascript:void(0); title="分享到 Myspace" data-sharer=myspace data-url=http://devops.alongparty.cn/posts/git%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E5%8E%9F%E7%90%86/ data-title=Git分支-分支原理 data-description><i data-svg-src=/lib/simple-icons/icons/myspace.min.svg></i></a>
<a href=javascript:void(0); title="分享到 Blogger" data-sharer=blogger data-url=http://devops.alongparty.cn/posts/git%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E5%8E%9F%E7%90%86/ data-title=Git分支-分支原理 data-description><i class="fa-brands fa-blogger fa-fw"></i></a>
<a href=javascript:void(0); title="分享到 Evernote" data-sharer=evernote data-url=http://devops.alongparty.cn/posts/git%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E5%8E%9F%E7%90%86/ data-title=Git分支-分支原理><i class="fa-brands fa-evernote fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw"></i>&nbsp;<a href=/tags/git/>Git</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/git%E5%88%86%E6%94%AF-%E8%BF%9C%E7%A8%8B%E5%88%86%E6%94%AF/ class=prev rel=prev title=Git分支-远程分支><i class="fa-solid fa-angle-left fa-fw"></i>Git分支-远程分支</a>
<a href=/posts/git%E5%88%86%E6%94%AF-%E5%8F%98%E5%9F%BA/ class=next rel=next title=Git分支-变基>Git分支-变基<i class="fa-solid fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=giscus><script src=https://giscus.app/client.js data-repo=kbsonlong/devops.alongparty.cn data-repo-id=R_kgDOHE7F-Q data-category=Announcements data-category-id=DIC_kwDOHE7F-c4CPP5J data-mapping=title data-theme=preferred_color_scheme data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-lang=zh-CN data-loading=lazy crossorigin=anonymous async defer></script><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app/ rel="external nofollow noopener noreferrer">giscus</a>.</noscript></div></div></article></main><footer class=footer><div class=footer-container><div class="footer-line copyright"><i class="fa-regular fa-copyright fa-fw"></i>
<span itemprop=copyrightYear>2018 - 2022</span><span class=author itemprop=copyrightHolder>
<a href=/>kbsonlong</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class="footer-line statistics"></div><div class="footer-line ibruce"><span id=busuanzi_container_site_uv title=总访客数><i class="fa-regular fa-user fa-fw"></i>&nbsp;<span id=busuanzi_value_site_uv><i class="fa fa-spinner fa-spin fa-fw"></i></span></span><span id=busuanzi_container_site_pv class=footer-divider title=总访问量><i class="fa-regular fa-eye fa-fw"></i>&nbsp;<span id=busuanzi_value_site_pv><i class="fa fa-spinner fa-spin fa-fw"></i></span></span></div><div class="footer-line beian"><span class="icp footer-divider"><a target=_blank href=https://beian.miit.gov.cn/>粤ICP备18122209号</a></span></div></div></footer></div><div class=widgets><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fa-solid fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fa-solid fa-comment fa-fw"></i></a></div><a href=https://github.com/kbsonlong title="在 GitHub 上查看源代码" target=_blank rel="external nofollow noopener noreferrer" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div></div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/katex/copy-tex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js defer></script><script type=text/javascript src=/lib/algoliasearch/algoliasearch-lite.umd.min.js defer></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js async defer></script><script type=text/javascript src=/lib/sharer/sharer.min.js async defer></script><script type=text/javascript src=/lib/katex/katex.min.js defer></script><script type=text/javascript src=/lib/katex/auto-render.min.js defer></script><script type=text/javascript src=/lib/katex/copy-tex.min.js defer></script><script type=text/javascript src=/lib/katex/mhchem.min.js defer></script><script type=text/javascript src=/lib/cookieconsent/cookieconsent.min.js defer></script><script type=text/javascript src=/lib/pangu/pangu.min.js defer></script><script type=text/javascript src=/lib/cell-watermark/watermark.min.js defer></script><script type=text/javascript src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js async defer></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:10},comment:{giscus:{darkTheme:"dark",lightTheme:"light"}},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验。"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},enablePWA:!0,enablePangu:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{algoliaAppID:"WFOR67TML1",algoliaIndex:"along",algoliaSearchKey:"ea1fe535f9a7ae353f3922489c829cc1",highlightTag:"em",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50,type:"algolia"},watermark:{content:'\u003cimg class="fixit-icon" src="/favicon-16x16.png" alt="FixIt logo" /\u003e FixIt 主题',enable:!0,height:21,opacity:.0125}}</script><script type=text/javascript src=/js/theme.min.js defer></script><script type=text/javascript src=/js/_custom.min.js defer></script></body></html>