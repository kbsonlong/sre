<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>Prometheus - 标签 - 蜷缩的蜗牛</title><link>https://kbsonlong.github.io/sre/tags/prometheus/</link><description>Prometheus - 标签 - 蜷缩的蜗牛</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><managingEditor>kbsonlong@gmail.com (kbsonlong)</managingEditor><webMaster>kbsonlong@gmail.com (kbsonlong)</webMaster><copyright>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</copyright><lastBuildDate>Tue, 13 Sep 2022 17:53:07 +0800</lastBuildDate><atom:link href="https://kbsonlong.github.io/sre/tags/prometheus/" rel="self" type="application/rss+xml"/><item><title>Prometheus Operator 常用指标</title><link>https://kbsonlong.github.io/sre/posts/adb863/</link><pubDate>Tue, 13 Sep 2022 17:53:07 +0800</pubDate><author>kbsonlong</author><guid>https://kbsonlong.github.io/sre/posts/adb863/</guid><description><![CDATA[<p>Prometheus Operator 安装完成后会有很多默认的监控指标，一不注意就大量的报警产生，所以我们非常有必要了解下这些常用的监控指标，有部分指标很有可能对于我们自己的业务可有可无，所以可以适当的进行修改，这里我们就来对常用的几个指标进行简单的说明。</p>
<h2 id="1-kubernetes-资源相关">1. Kubernetes 资源相关</h2>
<h3 id="11-cputhrottlinghigh">1.1 CPUThrottlingHigh</h3>
<p>关于 CPU 的 limit 合理性指标。查出最近5分钟，超过25%的 CPU 执行周期受到限制的容器。表达式：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">sum</span><span class="p">(</span><span class="n">increase</span><span class="p">(</span><span class="n">container_cpu_cfs_throttled_periods_total</span><span class="err">{</span><span class="n">container</span><span class="o">!=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="w"> </span><span class="err">}</span><span class="p">[</span><span class="mi">5</span><span class="n">m</span><span class="p">]))</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="p">(</span><span class="n">container</span><span class="p">,</span><span class="w"> </span><span class="n">pod</span><span class="p">,</span><span class="w"> </span><span class="n">namespace</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="o">/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">sum</span><span class="p">(</span><span class="n">increase</span><span class="p">(</span><span class="n">container_cpu_cfs_periods_total</span><span class="err">{}</span><span class="p">[</span><span class="mi">5</span><span class="n">m</span><span class="p">]))</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="p">(</span><span class="n">container</span><span class="p">,</span><span class="w"> </span><span class="n">pod</span><span class="p">,</span><span class="w"> </span><span class="n">namespace</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>相关指标：</p>
<ul>
<li>
<ul>
<li>container_cpu_cfs_periods_total：容器生命周期中度过的 cpu 周期总数</li>
</ul>
</li>
<li>container_cpu_cfs_throttled_periods_total：容器生命周期中度过的受限的 cpu 周期总数</li>
</ul>]]></description></item></channel></rss>